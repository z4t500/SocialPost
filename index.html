<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SocialPost</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #121212;
            --bg-darker: #0a0a0a;
            --bg-card: #1e1e1e;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --accent-color: #4a8bfc;
            --accent-hover: #3a7bec;
            --border-color: #333;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --error-color: #f44336;
            --owner-gradient: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent-color);
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .nav-links a:hover {
            color: var(--accent-color);
        }

        .nav-links a i {
            font-size: 16px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        .user-name {
            font-weight: 500;
            cursor: pointer;
        }

        .owner-badge {
            background: var(--owner-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
            font-size: 12px;
            margin-left: 5px;
        }

        .post-form {
            background-color: var(--bg-card);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: none;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }

        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background-color: var(--bg-darker);
            color: var(--text-primary);
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        .char-count {
            font-size: 12px;
            color: var(--text-secondary);
            text-align: right;
            margin-top: 5px;
        }

        .char-count.warning {
            color: var(--warning-color);
        }

        .char-count.error {
            color: var(--error-color);
        }

        .post-type-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .post-type-btn {
            flex: 1;
            padding: 10px;
            background-color: var(--bg-darker);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }

        .post-type-btn.active {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .post-type-btn i {
            margin-right: 8px;
        }

        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: 6px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .upload-area:hover {
            border-color: var(--accent-color);
            background-color: rgba(74, 139, 252, 0.05);
        }

        .upload-area i {
            font-size: 40px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .upload-area p {
            color: var(--text-secondary);
        }

        .upload-area input {
            display: none;
        }

        .preview-container {
            margin-top: 15px;
            display: none;
        }

        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .preview-video {
            max-width: 100%;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .link-preview {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 15px;
            display: none;
        }

        .link-preview-image {
            width: 100%;
            height: 200px;
            background-color: var(--bg-darker);
            background-size: cover;
            background-position: center;
        }

        .link-preview-content {
            padding: 15px;
        }

        .link-preview-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .link-preview-description {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 5px;
        }

        .link-preview-url {
            color: var(--accent-color);
            font-size: 12px;
        }

        .remove-btn {
            background-color: transparent;
            border: none;
            color: var(--warning-color);
            cursor: pointer;
            font-size: 14px;
            margin-top: 5px;
        }

        .submit-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 6px;
            padding: 12px 25px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
            width: 100%;
        }

        .submit-btn:hover {
            background-color: var(--accent-hover);
        }

        .submit-btn:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
        }

        .loading {
            display: none;
            text-align: center;
            margin-top: 15px;
        }

        .loading i {
            color: var(--accent-color);
            font-size: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .posts-container {
            margin-top: 30px;
        }

        .post {
            background-color: var(--bg-card);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        .post-user {
            font-weight: 500;
            cursor: pointer;
        }

        .post-time {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .post-content {
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .post-content p {
            margin-bottom: 10px;
        }

        .post-media {
            margin-bottom: 15px;
        }

        .post-media img {
            max-width: 100%;
            border-radius: 6px;
        }

        .post-media video {
            max-width: 100%;
            border-radius: 6px;
        }

        .post-link {
            border: 1px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .post-link-image {
            width: 100%;
            height: 200px;
            background-size: cover;
            background-position: center;
        }

        .post-link-content {
            padding: 15px;
        }

        .post-link-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .post-link-description {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 5px;
        }

        .post-link-url {
            color: var(--accent-color);
            font-size: 12px;
        }

        .post-actions {
            display: flex;
            border-top: 1px solid var(--border-color);
            padding-top: 10px;
        }

        .post-action {
            flex: 1;
            text-align: center;
            padding: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s;
            position: relative;
        }

        .post-action:hover {
            background-color: rgba(74, 139, 252, 0.1);
            color: var(--accent-color);
        }

        .post-action i {
            margin-right: 5px;
        }

        .emoji-picker {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--bg-card);
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 100;
            width: 200px;
        }

        .emoji-picker.show {
            display: block;
        }

        .emoji-option {
            display: inline-block;
            font-size: 20px;
            padding: 5px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .emoji-option:hover {
            transform: scale(1.2);
        }

        .emoji-reactions {
            display: flex;
            gap: 5px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .emoji-reaction {
            display: flex;
            align-items: center;
            background-color: var(--bg-darker);
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 14px;
        }

        .emoji-reaction-count {
            margin-left: 5px;
            font-size: 12px;
        }

        .success-message {
            background-color: rgba(76, 175, 80, 0.2);
            color: var(--success-color);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }

        .error-message {
            background-color: rgba(244, 67, 54, 0.2);
            color: var(--error-color);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }

        .login-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 70vh;
        }

        .login-message {
            margin-bottom: 30px;
            text-align: center;
            max-width: 500px;
        }

        .login-message h1 {
            font-size: 28px;
            margin-bottom: 15px;
        }

        .login-message p {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .google-login-btn {
            margin-top: 20px;
            background-color: white;
            color: #444;
            border: none;
            border-radius: 4px;
            padding: 10px 15px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .google-login-btn i {
            font-size: 20px;
        }

        .profile-container {
            display: none;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background-color: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: bold;
        }

        .profile-info h2 {
            font-size: 24px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }

        .profile-stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }

        .profile-stat {
            text-align: center;
        }

        .profile-stat-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--accent-color);
        }

        .profile-stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .profile-posts {
            margin-top: 30px;
        }

        .profile-posts h3 {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .public-status-container {
            display: none;
        }

        .public-status-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .public-status-header h2 {
            font-size: 24px;
        }

        .back-btn {
            background-color: transparent;
            border: none;
            color: var(--accent-color);
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Post menu */
        .post-menu {
            position: absolute;
            top: 15px;
            right: 15px;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .post-menu-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background-color: var(--bg-card);
            border-radius: 6px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            padding: 10px 0;
            width: 150px;
            display: none;
            z-index: 10;
        }

        .post-menu-dropdown.show {
            display: block;
        }

        .post-menu-item {
            padding: 8px 15px;
            color: var(--text-primary);
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .post-menu-item:hover {
            background-color: var(--bg-darker);
        }

        .post-menu-item.delete {
            color: var(--error-color);
        }

        /* Rich text editor styles */
        .editor-toolbar {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .editor-btn {
            background-color: var(--bg-darker);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .editor-btn:hover {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }

        .editor-btn.active {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            color: white;
        }

        /* Character limit indicator */
        .char-limit-indicator {
            height: 4px;
            background-color: var(--bg-darker);
            border-radius: 2px;
            margin-top: 5px;
            overflow: hidden;
        }

        .char-limit-progress {
            height: 100%;
            background-color: var(--accent-color);
            width: 0%;
            transition: width 0.3s;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .post-type-selector {
                flex-wrap: wrap;
            }
            
            .post-type-btn {
                flex: 1 0 45%;
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .profile-stats {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Screen -->
        <div class="login-container" id="loginContainer">
            <div class="login-message">
                <h1>Welcome to SocialPost</h1>
                <p>Connect with friends, share your thoughts, photos, videos and links.</p>
            </div>
            <button class="google-login-btn" id="loginBtn">
                <i class="fab fa-google"></i> Sign in with Google
            </button>
            <p id="loginStatus">Not logged in</p>
        </div>

        <!-- Main App (hidden until login) -->
        <div id="appContainer" style="display: none;">
            <header>
                <div class="logo">SocialPost</div>
                <div class="nav-links">
                    <a href="#" id="publicStatusLink"><i class="fas fa-globe"></i> View Public Status</a>
                    <a href="#" id="postLink"><i class="fas fa-plus"></i> Post</a>
                    <a href="#" id="profileLink"><i class="fas fa-user"></i> Profile</a>
                    <div class="user-info">
                        <div class="user-avatar" id="userAvatar"></div>
                        <div>
                            <div class="user-name" id="userName"></div>
                            <div id="ownerBadge" class="owner-badge" style="display: none;">Owner</div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle"></i> Your post has been published successfully!
            </div>

            <div class="error-message" id="errorMessage">
                <i class="fas fa-exclamation-circle"></i> <span id="errorMessageText"></span>
            </div>

            <!-- Post Form -->
            <div class="post-form" id="postForm">
                <div class="form-group">
                    <label for="description">Status Description</label>
                    <input type="text" id="description" placeholder="What's on your mind?" required>
                </div>

                <div class="post-type-selector">
                    <button class="post-type-btn active" data-type="text">
                        <i class="fas fa-font"></i> Text
                    </button>
                    <button class="post-type-btn" data-type="image">
                        <i class="fas fa-image"></i> Image
                    </button>
                    <button class="post-type-btn" data-type="video">
                        <i class="fas fa-video"></i> Video
                    </button>
                    <button class="post-type-btn" data-type="link">
                        <i class="fas fa-link"></i> Link
                    </button>
                </div>

                <div class="form-group" id="text-content-group">
                    <label for="content">Post Content (max. 500 characters)</label>
                    <div class="editor-toolbar">
                        <button class="editor-btn" data-command="bold" title="Bold"><i class="fas fa-bold"></i></button>
                        <button class="editor-btn" data-command="italic" title="Italic"><i class="fas fa-italic"></i></button>
                        <button class="editor-btn" data-command="underline" title="Underline"><i class="fas fa-underline"></i></button>
                        <button class="editor-btn" data-command="insertUnorderedList" title="Bullet List"><i class="fas fa-list-ul"></i></button>
                        <button class="editor-btn" data-command="insertOrderedList" title="Numbered List"><i class="fas fa-list-ol"></i></button>
                        <button class="editor-btn" data-command="createLink" title="Insert Link"><i class="fas fa-link"></i></button>
                    </div>
                    <div id="content" contenteditable="true" class="text-editor" style="min-height: 150px; padding: 12px; border: 1px solid #333; border-radius: 6px; background-color: #0a0a0a; color: #e0e0e0;"></div>
                    <div class="char-limit-indicator">
                        <div class="char-limit-progress" id="charLimitProgress"></div>
                    </div>
                    <div class="char-count"><span id="charCount">0</span>/500 characters</div>
                </div>

                <div class="form-group" id="image-content-group" style="display: none;">
                    <label>Upload Image</label>
                    <div class="upload-area" id="imageUploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Click to upload image or drag and drop</p>
                        <input type="file" id="imageInput" accept="image/*">
                    </div>
                    <div class="preview-container" id="imagePreviewContainer">
                        <img src="" alt="Preview" class="preview-image" id="imagePreview">
                        <button class="remove-btn" id="removeImageBtn"><i class="fas fa-trash"></i> Remove Image</button>
                    </div>
                </div>

                <div class="form-group" id="video-content-group" style="display: none;">
                    <label>Upload Video</label>
                    <div class="upload-area" id="videoUploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Click to upload video or drag and drop</p>
                        <input type="file" id="videoInput" accept="video/*">
                    </div>
                    <div class="preview-container" id="videoPreviewContainer">
                        <video controls class="preview-video" id="videoPreview"></video>
                        <button class="remove-btn" id="removeVideoBtn"><i class="fas fa-trash"></i> Remove Video</button>
                    </div>
                </div>

                <div class="form-group" id="link-content-group" style="display: none;">
                    <label for="linkUrl">Link URL</label>
                    <input type="text" id="linkUrl" placeholder="https://example.com">
                    <div class="link-preview" id="linkPreview">
                        <div class="link-preview-image" id="linkPreviewImage"></div>
                        <div class="link-preview-content">
                            <div class="link-preview-title" id="linkPreviewTitle"></div>
                            <div class="link-preview-description" id="linkPreviewDescription"></div>
                            <div class="link-preview-url" id="linkPreviewUrl"></div>
                        </div>
                    </div>
                </div>

                <button class="submit-btn" id="submitBtn">Post</button>
                <div class="loading" id="loadingIndicator">
                    <i class="fas fa-spinner"></i> Processing your post...
                </div>
            </div>

            <!-- Public Status Feed -->
            <div class="public-status-container" id="publicStatusContainer">
                <div class="public-status-header">
                    <h2><i class="fas fa-globe"></i> Public Status</h2>
                    <button class="back-btn" id="backFromPublicBtn"><i class="fas fa-arrow-left"></i> Back</button>
                </div>
                <div class="posts-container" id="publicPostsContainer">
                    <!-- Public posts will be added here dynamically -->
                </div>
            </div>

            <!-- Profile Section -->
            <div class="profile-container" id="profileContainer">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar"></div>
                    <div class="profile-info">
                        <h2 id="profileName"></h2>
                        <div id="profileOwnerBadge" class="owner-badge" style="display: none;">Owner</div>
                        <p class="profile-email" id="profileEmail"></p>
                        <div class="profile-stats">
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profilePostCount">0</div>
                                <div class="profile-stat-label">Posts</div>
                            </div>
                            <div class="profile-stat">
                                <div class="profile-stat-value" id="profileEmojiCount">0</div>
                                <div class="profile-stat-label">Emoji Responses</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="profile-posts">
                    <h3>Your Posts</h3>
                    <div class="posts-container" id="profilePostsContainer">
                        <!-- User's posts will be added here dynamically -->
                    </div>
                </div>
            </div>

            <!-- Main Feed -->
            <div class="posts-container" id="postsContainer">
                <!-- Posts will be added here dynamically -->
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { 
            getAuth, 
            GoogleAuthProvider, 
            signInWithPopup, 
            signOut,
            onAuthStateChanged 
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { 
            getFirestore,
            collection,
            addDoc,
            getDocs,
            query,
            orderBy,
            where,
            deleteDoc,
            doc,
            onSnapshot
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        import {
            getStorage,
            ref,
            uploadBytes,
            getDownloadURL
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC1nH7S3H6UXBNcRjx4wITwR5i0n8npG7s",
            authDomain: "socialpost-b521a.firebaseapp.com",
            projectId: "socialpost-b521a",
            storageBucket: "socialpost-b521a.appspot.com",
            messagingSenderId: "1089734629266",
            appId: "1:1089734629266:web:953ee276968e5e4e5c534b",
            measurementId: "G-N2866ZLRW7"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);
        const provider = new GoogleAuthProvider();

        // DOM elements
        const loginContainer = document.getElementById('loginContainer');
        const appContainer = document.getElementById('appContainer');
        const loginBtn = document.getElementById('loginBtn');
        const loginStatus = document.getElementById('loginStatus');
        const postForm = document.getElementById('postForm');
        const publicStatusContainer = document.getElementById('publicStatusContainer');
        const profileContainer = document.getElementById('profileContainer');
        const postsContainer = document.getElementById('postsContainer');
        const publicPostsContainer = document.getElementById('publicPostsContainer');
        const profilePostsContainer = document.getElementById('profilePostsContainer');
        const publicStatusLink = document.getElementById('publicStatusLink');
        const postLink = document.getElementById('postLink');
        const profileLink = document.getElementById('profileLink');
        const backFromPublicBtn = document.getElementById('backFromPublicBtn');
        const postTypeBtns = document.querySelectorAll('.post-type-btn');
        const textContentGroup = document.getElementById('text-content-group');
        const imageContentGroup = document.getElementById('image-content-group');
        const videoContentGroup = document.getElementById('video-content-group');
        const linkContentGroup = document.getElementById('link-content-group');
        const contentEditor = document.getElementById('content');
        const charCount = document.getElementById('charCount');
        const charLimitProgress = document.getElementById('charLimitProgress');
        const imageInput = document.getElementById('imageInput');
        const imagePreview = document.getElementById('imagePreview');
        const imagePreviewContainer = document.getElementById('imagePreviewContainer');
        const imageUploadArea = document.getElementById('imageUploadArea');
        const removeImageBtn = document.getElementById('removeImageBtn');
        const videoInput = document.getElementById('videoInput');
        const videoPreview = document.getElementById('videoPreview');
        const videoPreviewContainer = document.getElementById('videoPreviewContainer');
        const videoUploadArea = document.getElementById('videoUploadArea');
        const removeVideoBtn = document.getElementById('removeVideoBtn');
        const linkUrl = document.getElementById('linkUrl');
        const linkPreview = document.getElementById('linkPreview');
        const linkPreviewImage = document.getElementById('linkPreviewImage');
        const linkPreviewTitle = document.getElementById('linkPreviewTitle');
        const linkPreviewDescription = document.getElementById('linkPreviewDescription');
        const linkPreviewUrl = document.getElementById('linkPreviewUrl');
        const submitBtn = document.getElementById('submitBtn');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        const errorMessageText = document.getElementById('errorMessageText');
        const descriptionInput = document.getElementById('description');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const ownerBadge = document.getElementById('ownerBadge');
        const profileAvatar = document.getElementById('profileAvatar');
        const profileName = document.getElementById('profileName');
        const profileOwnerBadge = document.getElementById('profileOwnerBadge');
        const profileEmail = document.getElementById('profileEmail');
        const profileJoinDate = document.getElementById('profileJoinDate');
        const profilePostCount = document.getElementById('profilePostCount');
        const profileEmojiCount = document.getElementById('profileEmojiCount');
        const editorBtns = document.querySelectorAll('.editor-btn');

        // Current post type (default: text)
        let currentPostType = 'text';
        let selectedImage = null;
        let selectedVideo = null;
        let linkData = null;
        let currentUser = null;

        // Listen for auth state changes
        onAuthStateChanged(auth, (user) => {
            if (user) {
                // User is signed in
                currentUser = {
                    uid: user.uid,
                    name: user.displayName || user.email.split('@')[0],
                    email: user.email,
                    photoURL: user.photoURL,
                    isOwner: user.email === 'zatrmulus0@gmail.com'
                };
                
                loginContainer.style.display = 'none';
                appContainer.style.display = 'block';
                loginStatus.textContent = `Logged in as ${user.email}`;
                
                // Set user info in header
                userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
                userName.textContent = currentUser.name;
                
                if (currentUser.isOwner) {
                    ownerBadge.style.display = 'inline';
                }
                
                // Load posts
                loadPosts();
                showPostForm();
            } else {
                // User is signed out
                currentUser = null;
                loginContainer.style.display = 'flex';
                appContainer.style.display = 'none';
                loginStatus.textContent = 'Not logged in';
            }
        });

        // Google login handler
        loginBtn.addEventListener('click', async () => {
            try {
                const result = await signInWithPopup(auth, provider);
                console.log('Login successful:', result.user);
            } catch (error) {
                console.error('Login error:', error);
                showError('Login failed: ' + error.message);
            }
        });

        // Navigation handlers
        publicStatusLink.addEventListener('click', function(e) {
            e.preventDefault();
            showPublicStatus();
        });

        postLink.addEventListener('click', function(e) {
            e.preventDefault();
            showPostForm();
        });

        profileLink.addEventListener('click', function(e) {
            e.preventDefault();
            showProfile();
        });

        backFromPublicBtn.addEventListener('click', function(e) {
            e.preventDefault();
            showMainFeed();
        });

        function showPublicStatus() {
            postForm.style.display = 'none';
            publicStatusContainer.style.display = 'block';
            profileContainer.style.display = 'none';
            loadPublicPosts();
        }

        function showPostForm() {
            postForm.style.display = 'block';
            publicStatusContainer.style.display = 'none';
            profileContainer.style.display = 'none';
        }

        function showProfile() {
            postForm.style.display = 'none';
            publicStatusContainer.style.display = 'none';
            profileContainer.style.display = 'block';
            loadProfilePosts();
            updateProfileStats();
        }

        function showMainFeed() {
            postForm.style.display = 'none';
            publicStatusContainer.style.display = 'none';
            profileContainer.style.display = 'none';
        }

        // Post type switching
        postTypeBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                postTypeBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentPostType = this.dataset.type;

                // Hide all content groups
                textContentGroup.style.display = 'none';
                imageContentGroup.style.display = 'none';
                videoContentGroup.style.display = 'none';
                linkContentGroup.style.display = 'none';

                // Show the selected one
                document.getElementById(`${currentPostType}-content-group`).style.display = 'block';
            });
        });

        // Character count for text editor
        contentEditor.addEventListener('input', function() {
            const text = this.innerText;
            const count = text.length;
            charCount.textContent = count;
            
            // Update progress bar
            const progress = (count / 500) * 100;
            charLimitProgress.style.width = `${Math.min(progress, 100)}%`;
            
            // Change color if approaching limit
            if (count >= 500) {
                charCount.classList.add('error');
                charLimitProgress.style.backgroundColor = 'var(--error-color)';
                
                // Truncate content if over limit
                if (count > 500) {
                    this.textContent = this.textContent.substring(0, 500);
                    charCount.textContent = 500;
                    charLimitProgress.style.width = '100%';
                }
            } else if (count >= 400) {
                charCount.classList.remove('error');
                charCount.classList.add('warning');
                charLimitProgress.style.backgroundColor = 'var(--warning-color)';
            } else {
                charCount.classList.remove('error', 'warning');
                charLimitProgress.style.backgroundColor = 'var(--accent-color)';
            }
        });

        // Image upload handling
        imageUploadArea.addEventListener('click', function() {
            imageInput.click();
        });

        imageInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                const file = e.target.files[0];
                if (file.size > 5 * 1024 * 1024) { // 5MB limit
                    showError('Image size should be less than 5MB');
                    return;
                }
                
                selectedImage = file;
                const reader = new FileReader();
                reader.onload = function(event) {
                    imagePreview.src = event.target.result;
                    imagePreviewContainer.style.display = 'block';
                };
                reader.readAsDataURL(selectedImage);
            }
        });

        removeImageBtn.addEventListener('click', function() {
            selectedImage = null;
            imagePreview.src = '';
            imagePreviewContainer.style.display = 'none';
            imageInput.value = '';
        });

        // Video upload handling
        videoUploadArea.addEventListener('click', function() {
            videoInput.click();
        });

        videoInput.addEventListener('change', function(e) {
            if (e.target.files.length > 0) {
                const file = e.target.files[0];
                if (file.size > 20 * 1024 * 1024) { // 20MB limit
                    showError('Video size should be less than 20MB');
                    return;
                }
                
                selectedVideo = file;
                const reader = new FileReader();
                reader.onload = function(event) {
                    videoPreview.src = event.target.result;
                    videoPreviewContainer.style.display = 'block';
                };
                reader.readAsDataURL(selectedVideo);
            }
        });

        removeVideoBtn.addEventListener('click', function() {
            selectedVideo = null;
            videoPreview.src = '';
            videoPreviewContainer.style.display = 'none';
            videoInput.value = '';
        });

        // Link preview handling
        linkUrl.addEventListener('blur', function() {
            const url = this.value.trim();
            if (url) {
                // Validate URL
                try {
                    new URL(url);
                } catch (e) {
                    showError('Please enter a valid URL');
                    return;
                }
                
                // In a real app, you would fetch link metadata from a server
                // Here we'll simulate it with some sample data
                simulateFetchLinkMetadata(url);
            } else {
                linkPreview.style.display = 'none';
            }
        });

        function simulateFetchLinkMetadata(url) {
            // Simulate API delay
            setTimeout(() => {
                // Sample data - in a real app, you'd get this from a link preview API
                linkData = {
                    url: url,
                    title: "Example Website",
                    description: "This is an example description of the linked website. It might contain some details about the page content.",
                    image: "https://via.placeholder.com/600x400?text=Link+Preview"
                };

                // Update the preview
                linkPreviewImage.style.backgroundImage = `url(${linkData.image})`;
                linkPreviewTitle.textContent = linkData.title;
                linkPreviewDescription.textContent = linkData.description;
                linkPreviewUrl.textContent = new URL(url).hostname;
                linkPreview.style.display = 'block';
            }, 800);
        }

        // Rich text editor functionality
        editorBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const command = this.dataset.command;
                
                if (command === 'createLink') {
                    const url = prompt('Enter the URL:');
                    if (url) {
                        document.execCommand(command, false, url);
                    }
                } else {
                    document.execCommand(command, false, null);
                    this.classList.toggle('active');
                }
                
                contentEditor.focus();
            });
        });

        // Form submission
        submitBtn.addEventListener('click', async function() {
            if (!currentUser) {
                showError('Please login first');
                return;
            }

            if (!descriptionInput.value.trim()) {
                showError('Please fill in your status description');
                return;
            }

            // Validate based on post type
            if (currentPostType === 'text' && contentEditor.innerText.trim().length === 0) {
                showError('Please enter some content for your post');
                return;
            }

            if (currentPostType === 'image' && !selectedImage) {
                showError('Please select an image to upload');
                return;
            }

            if (currentPostType === 'video' && !selectedVideo) {
                showError('Please select a video to upload');
                return;
            }

            if (currentPostType === 'link' && !linkUrl.value.trim()) {
                showError('Please enter a valid URL');
                return;
            }

            // Disable the submit button and show loading
            submitBtn.disabled = true;
            loadingIndicator.style.display = 'block';
            hideError();

            try {
                let mediaUrl = null;
                let mediaType = null;

                // Handle media upload if needed
                if (currentPostType === 'image' && selectedImage) {
                    const storageRef = ref(storage, `posts/${currentUser.uid}/${Date.now()}_${selectedImage.name}`);
                    const snapshot = await uploadBytes(storageRef, selectedImage);
                    mediaUrl = await getDownloadURL(snapshot.ref);
                    mediaType = 'image';
                } else if (currentPostType === 'video' && selectedVideo) {
                    const storageRef = ref(storage, `posts/${currentUser.uid}/${Date.now()}_${selectedVideo.name}`);
                    const snapshot = await uploadBytes(storageRef, selectedVideo);
                    mediaUrl = await getDownloadURL(snapshot.ref);
                    mediaType = 'video';
                }

                // Create post data
                const postData = {
                    userId: currentUser.uid,
                    userName: currentUser.name,
                    userEmail: currentUser.email,
                    userInitial: currentUser.name.charAt(0).toUpperCase(),
                    description: descriptionInput.value.trim(),
                    type: currentPostType,
                    content: contentEditor.innerHTML,
                    timestamp: new Date().toISOString(),
                    likes: 0,
                    comments: [],
                    shares: 0,
                    emojiResponses: {}
                };

                // Add media data if available
                if (mediaUrl) {
                    postData.media = {
                        type: mediaType,
                        url: mediaUrl
                    };
                }

                // Add link data if available
                if (currentPostType === 'link' && linkData) {
                    postData.link = linkData;
                }

                // Add to Firestore
                const docRef = await addDoc(collection(db, 'posts'), postData);
                console.log('Post created with ID: ', docRef.id);

                showSuccess();
                resetForm();
                
                // Hide success message after 3 seconds
                setTimeout(() => {
                    hideSuccess();
                }, 3000);
            } catch (error) {
                console.error('Error creating post:', error);
                showError('Failed to create post: ' + error.message);
            } finally {
                loadingIndicator.style.display = 'none';
                submitBtn.disabled = false;
            }
        });

        // Load posts from Firestore
        async function loadPosts() {
            const postsQuery = query(collection(db, 'posts'), orderBy('timestamp', 'desc'));
            
            // Real-time listener
            onSnapshot(postsQuery, (snapshot) => {
                postsContainer.innerHTML = '';
                snapshot.forEach((doc) => {
                    const post = doc.data();
                    post.id = doc.id;
                    renderPost(post, postsContainer);
                });
            });
        }

        // Load public posts
        async function loadPublicPosts() {
            const postsQuery = query(collection(db, 'posts'), orderBy('timestamp', 'desc'));
            
            // Real-time listener
            onSnapshot(postsQuery, (snapshot) => {
                publicPostsContainer.innerHTML = '';
                snapshot.forEach((doc) => {
                    const post = doc.data();
                    post.id = doc.id;
                    renderPost(post, publicPostsContainer);
                });
            });
        }

        // Load profile posts
        async function loadProfilePosts() {
            if (!currentUser) return;
            
            const postsQuery = query(
                collection(db, 'posts'),
                where('userId', '==', currentUser.uid),
                orderBy('timestamp', 'desc')
            );
            
            // Real-time listener
            onSnapshot(postsQuery, (snapshot) => {
                profilePostsContainer.innerHTML = '';
                snapshot.forEach((doc) => {
                    const post = doc.data();
                    post.id = doc.id;
                    renderPost(post, profilePostsContainer);
                });
            });
        }

        function renderPost(post, container, prepend = false) {
            const postElement = document.createElement('div');
            postElement.className = 'post';
            postElement.dataset.postId = post.id;
            
            const postDate = new Date(post.timestamp);
            const timeString = postDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            const dateString = postDate.toLocaleDateString();
            
            let mediaHtml = '';
            
            if (post.type === 'image' && post.media) {
                mediaHtml = `
                    <div class="post-media">
                        <img src="${post.media.url}" alt="Posted image">
                    </div>
                `;
            }
            else if (post.type === 'video' && post.media) {
                mediaHtml = `
                    <div class="post-media">
                        <video controls src="${post.media.url}"></video>
                    </div>
                `;
            }
            else if (post.type === 'link' && post.link) {
                mediaHtml = `
                    <div class="post-link">
                        <div class="post-link-image" style="background-image: url(${post.link.image})"></div>
                        <div class="post-link-content">
                            <div class="post-link-title">${post.link.title}</div>
                            <div class="post-link-description">${post.link.description}</div>
                            <div class="post-link-url">${new URL(post.link.url).hostname}</div>
                        </div>
                    </div>
                `;
            }
            
            // Build emoji reactions HTML
            let emojiReactionsHtml = '';
            const emojiResponses = post.emojiResponses || {};
            const emojiCount = Object.values(emojiResponses).reduce((sum, count) => sum + count, 0);
            
            if (emojiCount > 0) {
                emojiReactionsHtml = '<div class="emoji-reactions">';
                for (const [emoji, count] of Object.entries(emojiResponses)) {
                    if (count > 0) {
                        emojiReactionsHtml += `
                            <div class="emoji-reaction">
                                ${emoji}
                                <span class="emoji-reaction-count">${count}</span>
                            </div>
                        `;
                    }
                }
                emojiReactionsHtml += '</div>';
            }
            
            // Check if current user is owner of this post
            const isCurrentUserPost = post.userId === currentUser?.uid;
            
            // Post menu (only show if current user is the post owner)
            const postMenuHtml = isCurrentUserPost ? `
                <div class="post-menu">
                    <i class="fas fa-ellipsis-h"></i>
                    <div class="post-menu-dropdown">
                        <div class="post-menu-item delete" data-action="delete">Delete This Status</div>
                    </div>
                </div>
            ` : '';
            
            postElement.innerHTML = `
                ${postMenuHtml}
                <div class="post-header">
                    <div class="post-avatar">${post.userInitial}</div>
                    <div>
                        <div class="post-user">
                            ${post.userName}
                            ${post.userEmail === 'zatrmulus0@gmail.com' ? '<span class="owner-badge">Owner</span>' : ''}
                        </div>
                        <div class="post-time">${dateString} at ${timeString}</div>
                    </div>
                </div>
                <div class="post-content">
                    <strong>${post.description}</strong>
                    <p>${post.content}</p>
                </div>
                ${mediaHtml}
                ${emojiReactionsHtml}
                <div class="post-actions">
                    <div class="post-action like-btn">
                        <i class="far fa-thumbs-up"></i> Like
                        <div class="emoji-picker">
                            <div class="emoji-option" data-emoji="👍">👍</div>
                            <div class="emoji-option" data-emoji="❤️">❤️</div>
                            <div class="emoji-option" data-emoji="😂">😂</div>
                            <div class="emoji-option" data-emoji="😮">😮</div>
                            <div class="emoji-option" data-emoji="😢">😢</div>
                            <div class="emoji-option" data-emoji="🎉">🎉</div>
                        </div>
                    </div>
                    <div class="post-action"><i class="far fa-comment"></i> Comment</div>
                    <div class="post-action"><i class="fas fa-share"></i> Share</div>
                </div>
            `;
            
            if (prepend) {
                container.prepend(postElement);
            } else {
                container.appendChild(postElement);
            }
            
            // Add event listeners for emoji picker
            const likeBtn = postElement.querySelector('.like-btn');
            const emojiPicker = postElement.querySelector('.emoji-picker');
            
            likeBtn.addEventListener('click', function(e) {
                if (e.target.classList.contains('emoji-option')) {
                    return; // This is handled by the emoji option click handler
                }
                emojiPicker.classList.toggle('show');
            });
            
            // Close emoji picker when clicking outside
            document.addEventListener('click', function(e) {
                if (!likeBtn.contains(e.target)) {
                    emojiPicker.classList.remove('show');
                }
            });
            
            // Handle emoji selection
            postElement.querySelectorAll('.emoji-option').forEach(emojiOption => {
                emojiOption.addEventListener('click', function() {
                    const emoji = this.dataset.emoji;
                    addEmojiResponse(post.id, emoji);
                    emojiPicker.classList.remove('show');
                    
                    // Update the post to show the new reaction
                    updatePostReactions(post.id);
                });
            });
            
            // Handle post menu
            if (isCurrentUserPost) {
                const postMenu = postElement.querySelector('.post-menu');
                const postMenuDropdown = postElement.querySelector('.post-menu-dropdown');
                const deleteBtn = postElement.querySelector('.post-menu-item.delete');
                
                postMenu.addEventListener('click', function(e) {
                    e.stopPropagation();
                    postMenuDropdown.classList.toggle('show');
                });
                
                deleteBtn.addEventListener('click', async function(e) {
                    e.stopPropagation();
                    if (confirm('Are you sure you want to delete this post?')) {
                        try {
                            await deleteDoc(doc(db, 'posts', post.id));
                            console.log('Post deleted successfully');
                        } catch (error) {
                            console.error('Error deleting post:', error);
                            showError('Failed to delete post');
                        }
                    }
                });
                
                // Close menu when clicking outside
                document.addEventListener('click', function() {
                    postMenuDropdown.classList.remove('show');
                });
            }
        }

        async function addEmojiResponse(postId, emoji) {
            if (!currentUser) return;
            
            try {
                // In a real app, you would update the emoji response count in Firestore
                // For simplicity, we'll just update the UI here
                const postElement = document.querySelector(`.post[data-post-id="${postId}"]`);
                if (!postElement) return;
                
                // Update UI immediately
                const emojiReactions = postElement.querySelector('.emoji-reactions') || 
                    document.createElement('div');
                
                if (!emojiReactions.classList.contains('emoji-reactions')) {
                    emojiReactions.className = 'emoji-reactions';
                    postElement.querySelector('.post-content').insertAdjacentElement('afterend', emojiReactions);
                }
                
                let emojiElement = emojiReactions.querySelector(`.emoji-reaction:contains("${emoji}")`);
                if (!emojiElement) {
                    emojiElement = document.createElement('div');
                    emojiElement.className = 'emoji-reaction';
                    emojiElement.innerHTML = `
                        ${emoji}
                        <span class="emoji-reaction-count">1</span>
                    `;
                    emojiReactions.appendChild(emojiElement);
                } else {
                    const countElement = emojiElement.querySelector('.emoji-reaction-count');
                    const currentCount = parseInt(countElement.textContent) || 0;
                    countElement.textContent = currentCount + 1;
                }
                
                // In a real app, you would update Firestore here
                // await updateDoc(doc(db, 'posts', postId), {
                //     [`emojiResponses.${emoji}`]: increment(1)
                // });
                
            } catch (error) {
                console.error('Error adding emoji reaction:', error);
            }
        }

        function updatePostReactions(postId) {
            // In a real app, you would get this data from Firestore
            // For now, we'll just update the UI if the element exists
            const postElement = document.querySelector(`.post[data-post-id="${postId}"]`);
            if (!postElement) return;
            
            // This would be replaced with actual Firestore data
            const emojiResponses = {};
            const emojiCount = Object.values(emojiResponses).reduce((sum, count) => sum + count, 0);
            
            if (emojiCount > 0) {
                let emojiReactionsHtml = '<div class="emoji-reactions">';
                for (const [emoji, count] of Object.entries(emojiResponses)) {
                    if (count > 0) {
                        emojiReactionsHtml += `
                            <div class="emoji-reaction">
                                ${emoji}
                                <span class="emoji-reaction-count">${count}</span>
                            </div>
                        `;
                    }
                }
                emojiReactionsHtml += '</div>';
                
                const existingReactions = postElement.querySelector('.emoji-reactions');
                if (existingReactions) {
                    existingReactions.innerHTML = emojiReactionsHtml;
                } else {
                    const postContent = postElement.querySelector('.post-content');
                    if (postContent) {
                        postContent.insertAdjacentHTML('afterend', emojiReactionsHtml);
                    }
                }
            }
        }

        async function updateProfileStats() {
            if (!currentUser) return;
            
            try {
                // Get user's posts count
                const postsQuery = query(
                    collection(db, 'posts'),
                    where('userId', '==', currentUser.uid)
                );
                const postsSnapshot = await getDocs(postsQuery);
                const postCount = postsSnapshot.size;
                profilePostCount.textContent = postCount;
                
                // Calculate total emoji responses (simplified for demo)
                let emojiCount = 0;
                postsSnapshot.forEach(doc => {
                    const post = doc.data();
                    if (post.emojiResponses) {
                        emojiCount += Object.values(post.emojiResponses).reduce((sum, count) => sum + count, 0);
                    }
                });
                
                // Special case for owner
                if (currentUser.email === 'zatrmulus0@gmail.com') {
                    emojiCount = 953; // Starting with 953 as requested
                    profileEmojiCount.textContent = '953B+';
                } else {
                    profileEmojiCount.textContent = emojiCount;
                }
                
                // Update profile info
                profileAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
                profileName.textContent = currentUser.name;
                profileEmail.textContent = currentUser.email;
                
                if (currentUser.email === 'zatrmulus0@gmail.com') {
                    profileOwnerBadge.style.display = 'inline';
                } else {
                    profileOwnerBadge.style.display = 'none';
                }
                
                // For join date, we would typically store this in the user's document
                profileJoinDate.textContent = `Joined on ${new Date().toLocaleDateString()}`;
                
            } catch (error) {
                console.error('Error updating profile stats:', error);
            }
        }

        function resetForm() {
            descriptionInput.value = '';
            contentEditor.innerHTML = '';
            charCount.textContent = '0';
            charLimitProgress.style.width = '0%';
            charCount.classList.remove('error', 'warning');
            
            if (selectedImage) {
                selectedImage = null;
                imagePreview.src = '';
                imagePreviewContainer.style.display = 'none';
                imageInput.value = '';
            }
            
            if (selectedVideo) {
                selectedVideo = null;
                videoPreview.src = '';
                videoPreviewContainer.style.display = 'none';
                videoInput.value = '';
            }
            
            if (linkData) {
                linkData = null;
                linkUrl.value = '';
                linkPreview.style.display = 'none';
            }
            
            // Reset to text post type
            postTypeBtns.forEach(btn => btn.classList.remove('active'));
            postTypeBtns[0].classList.add('active');
            currentPostType = 'text';
            textContentGroup.style.display = 'block';
            imageContentGroup.style.display = 'none';
            videoContentGroup.style.display = 'none';
            linkContentGroup.style.display = 'none';
            
            submitBtn.disabled = false;
        }

        function showSuccess() {
            successMessage.style.display = 'block';
        }

        function hideSuccess() {
            successMessage.style.display = 'none';
        }

        function showError(message) {
            errorMessageText.textContent = message;
            errorMessage.style.display = 'block';
        }

        function hideError() {
            errorMessage.style.display = 'none';
        }

        // Drag and drop functionality for image and video uploads
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            imageUploadArea.addEventListener(eventName, preventDefaults, false);
            videoUploadArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            imageUploadArea.addEventListener(eventName, highlight, false);
            videoUploadArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            imageUploadArea.addEventListener(eventName, unhighlight, false);
            videoUploadArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight(e) {
            this.style.borderColor = 'var(--accent-color)';
            this.style.backgroundColor = 'rgba(74, 139, 252, 0.1)';
        }

        function unhighlight(e) {
            this.style.borderColor = 'var(--border-color)';
            this.style.backgroundColor = '';
        }

        imageUploadArea.addEventListener('drop', handleImageDrop, false);
        videoUploadArea.addEventListener('drop', handleVideoDrop, false);

        function handleImageDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length > 0) {
                const file = files[0];
                if (file.type.startsWith('image/')) {
                    if (file.size > 5 * 1024 * 1024) { // 5MB limit
                        showError('Image size should be less than 5MB');
                        return;
                    }
                    
                    selectedImage = file;
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        imagePreview.src = event.target.result;
                        imagePreviewContainer.style.display = 'block';
                    };
                    reader.readAsDataURL(selectedImage);
                }
            }
        }

        function handleVideoDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length > 0) {
                const file = files[0];
                if (file.type.startsWith('video/')) {
                    if (file.size > 20 * 1024 * 1024) { // 20MB limit
                        showError('Video size should be less than 20MB');
                        return;
                    }
                    
                    selectedVideo = file;
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        videoPreview.src = event.target.result;
                        videoPreviewContainer.style.display = 'block';
                    };
                    reader.readAsDataURL(selectedVideo);
                }
            }
        }
    </script>
</body>

</html>

